import string
import re
file_commands = 'commands.1.txt'
file_proteins = 'sequences.1.txt'

def read_command(filename):
    proteins = []
    file = open(filename, 'r', encoding='utf-8')
    for line in file:
        parts = line.strip().split('\t') #разделяем строку по табуляции и после сохраняем как кортеж
        protein_data = (
            parts[0].strip(), #name
            parts[1].strip(), #organism
            parts[2].strip()  #sequence
        )
        proteins.append(protein_data)
    return proteins

def read_commands_data(filename):
    commands=[]
    file = open(filename, 'r',encoding='utf-8')
    for line in file:
        parts=line.strip().split('\t')
        commands_data= (
            parts[0].strip(),
            parts[1].strip(),
        )
        commands.append(commands_data)
    return commands

def decode(werb):
    word = ""
    i = 0
    while i < len(werb):
        if werb[i].isdigit(): #проверяем каждый элемени на то является ли цифрой
            count = int(werb[i]) #запоминаем какое число стоит на позиции i
            letter = werb[i+1]  #запоминаем букву которая идет после нашей цифры
            word += letter * count #преобразование
            i += 2 #переход к след цифре
        else:
            word += werb[i]
            i += 1
    return word

def search_data(protein):
    protein = decode(protein) #преобразование
    proteins = read_command(file_proteins)
    search = ""
    for item in proteins:
        sequence = item[2] #последовательность белка
        command = item[1] #команда для белка

        if sequence.find(protein) != -1: #если последовательность найдена формируем результат
            search = command + " " + sequence
            break
    if search == "":
        return "NOT FOUND"
    else:
        return search

def mode(protein):
    if protein == "": #проверка ввели ли название белка
        return "MISSING"

    proteins = read_command(file_proteins)
    mode_app = "" #последовательность найденного белка
    for item in proteins:
        if item[0] == protein:
            mode_app = item[2]#если имя совпало сохраняем последовательность найденного с начальным
            break

    if mode_app == "":
        return "NOT FOUND"
    letters = dict() #создаем словарь
    for ch in mode_app:
        letters[ch] = letters.get(ch, 0) + 1 #увеличение счетчика для каждой буквы,get ищет
        # если находит то присваивает индекс к ch,если нет то 0.+1 добавляет еще одно появление

    max_ver = max(letters.values()) #нахождение самого большого количества повторений

    for ch in sorted(letters):#проходим по ключам в алфавитном порядке
        if letters[ch] == max_ver:
            return ch, max_ver

def diff(protein1, protein2):
    proteins = read_command(file_proteins)
    f_protein1 = ''
    f_protein2 = ''

    for i in range(len(proteins)):
        if (proteins[i])[0] == protein1: #сравнение имени первого элемента кортежа 
            f_protein1 = (proteins[i])[2] #берем последовательность белка

    if f_protein1 == '':
        return 'MISSING'

    for i in range(len(proteins)):
        if (proteins[i])[0] == protein2:
            f_protein2 = (proteins[i])[2]

    if f_protein2 == '':
        return 'MISSING'
